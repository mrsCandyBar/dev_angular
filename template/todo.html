<article class="contentHolder">

  <button class="btn btn-xs btn-default" onclick="history.back()">Back</button>

  <a 
    ng-if="isAdmin"
    ng-show="!editable && todo.status === 'Done'"
    ng-click="moveTodo()"
    class="btn btn-xs btn-primary">{{ todo.isActive === true ? 'Archive' : 'Activate' }}</a>

  <a 
    ng-if="isAdmin"
    ng-show="!editable"
    ng-click="deleteTodo()"
    class="btn btn-xs btn-primary">Delete</a>

  <h3 class="contentHolder__todoHolder editable">
    <span ng-show="!editable && isAdmin || !isAdmin">{{ todo.title }}</span>
    <input 
      ng-if="isAdmin"
      ng-show="editable" 
      ng-model="todo.title" /><br>

    <div>
      <span ng-show="!editable && isAdmin || !isAdmin">{{ taskDates.total }}</span>
      <div 
        ng-if="isAdmin"
        ng-show="editable" 
        class="form-group col">
          From <datepicker info="todo.dateStart"></datepicker>
          To <datepicker info="todo.dateEnd"></datepicker>
      </div>
    </div>

    <small>
      <span ng-show="!editable">{{ todo.status }}</span>
      <div ng-show="editable" class="form-group col">
        <br><b>Task state: </b><br>
        <span ng-repeat="state in todoStates.status">
          <input type="radio" name="Status" value="{{ state }}" 
            ng-model="todo.status"> {{ state }}<br>
        </span>
      </div>
    </small>

    <small>
      <span ng-show="!editable">( <i>{{ todo.urgency }}</i> )</span>
      <div 
        ng-if="isAdmin"
        ng-show="editable" 
        class="form-group col">
          <span ng-repeat="state in todoStates.urgency">
            <input type="radio" name="Urgency" value="{{ state }}" 
              ng-model="todo.urgency"> {{ state }}<br>
          </span>
      </div>
    </small> 
  </h3>

  
  <p ng-show="!editable && isAdmin || !isAdmin">{{ todo.description }}</p>
  <textarea 
    ng-if="isAdmin"
    ng-show="editable" 
    class="form-control" 
    ng-model="todo.description"></textarea>
  
  <section class="contentHolder__comments" ng-show="isAdmin && todo.comments || !isAdmin">
    <span>{{todoList.comments.length}} comments</span>


  <!-- Reply -->
    <ul 
      ng-show="todo.comments"
      class="unstyled">
      <li ng-repeat="comment in todo.comments">
        <h5>{{ comment.name }} said</h5>
        <p>{{ comment.message }}</p>

         <!-- Reply to response -->
        <ul class="unstyled">
          <li ng-repeat="reply in comment.reply">
            <h5>{{ reply.name }} said</h5>
            <p>{{ reply.message }}</p>
          </li>
        </ul>

        <article>
          <h5>reply</h5>
          <textarea ng-model="reply[comment.id].message" class="form-control"></textarea>
          <button ng-click="replyToComment(comment.id)" class="btn btn-sm btn-default">Reply</button>
        </article>
s
      </li>
    </ul>

    <article>
      <br><br>
      <h5>Comment from : {{ comment.name }}</h5>
      <textarea ng-model="comment.message" class="form-control"></textarea>
      <button ng-click="addComment()" class="btn btn-sm btn-default">Comment</button>
    </article>
    
  </section>

  <br><br>
  <button class="btn btn-primary" ng-click="update()">{{ editable ? 'Save' : 'Edit' }}</button>
  <button ng-show="editable" class="btn btn-primary" ng-click="cancel()">cancel</button>

</article>